# MUD-Game

## 文件构成

``` . ├── CMakelists.txt    # 制定编译文件
├── README.md         # 项目说明
├── src               # 项目代码
└── tests             # 测试代码
```

## 规范

### 注释

注释使用 [Doxygen](https://doxygen.nl/manual/) 规范，这个框架可以方便地生成项目文档供其他成员使用，而且注释的可读性很高，上手简单，用 AI 生成几个例子就会了。

**Doxygen 可用标签速查**：[Special Commands](https://www.doxygen.nl/manual/commands.html)

可以在项目根目录下运行 `doxygen` 来生成项目文档，为了避免不必要的麻烦，我将 `docs/` 这个目录加入了 `.gitignore`，这可以避免项目成员生成的 `docs/` 之间的 conflict.

### 测试框架

测试框架我以前用过一个更小型的，用起来很香，可以非常快速的测试代码。他可以让我们预先设定好什么场景下程序应该有怎样的行为，如果我们设置了若干个场景，那么每次修改完代码就可以通过测试框架测试现在的代码对所有场景是否都适用。我们这个项目就使用 [Catch](https://github.com/catchorg/Catch2/blob/v2.x/docs/tutorial.md#top) (比较轻量化)

### Git

1. 应当尽量避免 merge 而是使用 rebase, 一个常见的工作流可以参见这个[视频](bilibili.com/video/BV19e4y1q7JJ/?spm_id_from=333.337.search-card.all.click)，不同的是我们使用 pull request 来合并到 master 分支

2. 尽量规范的书写 commit 的描述，这可以帮助我们准确的寻找并回滚代码，参见[如何规范你的Git commit](https://zhuanlan.zhihu.com/p/182553920)

3. 大家添加新功能的时候请添加一个新分支，比如我要写一个地图的新功能，我就会从 master 新建一个 feature-map 分支出来，写完所有功能，并且测试完成之后，再写一个 PR 合并到 master 分支（直接在 master 分支编辑真的会出现意想不到的错误😭）

### 编码规范

大家可以先去读一下 Google 的 [Style Guide](https://google.github.io/styleguide/cppguide.html), 讲了各种场景下的编码规范，按照规范写的代码可读性一般都很高。

#### 命名

然后我就确定一下命名规范了，大家觉得这种格式不合适可以提一下建议：

- 变量：变量采用蛇形命名法，即 `min_value` 的形式

- 函数：函数采用小驼峰命名法，即 `getValue` 的形式

- 类：采用大驼峰命名法，即 `MapLoader` 的形式

- 常量：采用全大写加下划线分割，即 `MATH_PI` 的形式

大家可以自行补充

#### using

这个地方强烈建议**不要**使用 `using namespace std;` 的形式直接导入命名空间，这会导致命名冲突问题，更好的方案是导入常用的函数、变量等：

```cpp
// 划分成多行只是为了格式美观
using std::cin, std::cout;
using std::string, std::endl;

// 如果想使用 vector
#include <vector>
// 如果需要频繁用到
using std::vector;
vector<int> my_vector;
// 不需要频繁使用
// std::vector<int> my_vecotr;
```
### 特殊符号对照表

 | 符号码点 | 符号描述 | 符号索引 | 符号宽度 |
 |----------|----------|----------|----------|
 | f1302    | 床       | 0        | 2        |
 | c6c3     | 主角     | 1        | 2        |
 | f0c3c    | 篮球框   | 2        | 2        |
 | 2554     | 左上拐角 | 3        | 1        |
 | 255a     | 左下拐角 | 4        | 1        |
 | 2557     | 右上拐角 | 5        | 1        |
 | 255d     | 右下拐角 | 6        | 1        |
 | 2550     | 水平墙壁 | 7        | 1        |
 | 2551     | 竖直墙壁 | 8        | 1        |
 | ?        | NPC      | 9        | ?        |

- `出口` 使用在出口的最上方或最左边的字母 o 来表示，该字母 o 不会和上表冲突
- `入口` 使用在入口的最上方或最左边的字母 i 来表示，该字母 i 不会和上表冲突

> 所有如果出口的数量有多个，只需要在每个场景中提供一个数组, Map 就可以根据该数组自行分配出口会到达哪一个场景

所有 NPC 使用上表中的 9 来表示，地图会自动分配 NPC, 只需要在一个人物类中提供一个所有 NPC 的编号数组即可

一个具体的例子是(经过重新设计，现在可以支持不规则的地图了)：

> ⚠️ 重要更改：横坐标用 y 来表示，纵坐标用 x 来表示

```text
注意，下边的行号和列号只是为了方便说明，真实的地图文件中请不要写  
另外，我们统一使用 x 表示行号，即纵坐标，用 y 表示列号，即横坐标

  123456789ABCDEFGHIJKLMNOPQR
1 ##########o   ######
2 # 0                #
3 #                  ########
4 #                         #
5 #    9                    o
6 #            1             
7 #                         #
8 #9                 ########
9 #                  #
A ####      ##i   ####
B    #      #
C    #      #
D    #      #
E    ########
```

0 表示一张床  
1 表示主角  
9 是 NPC  

这张地图里面一共有 2 个出口，两个 NPC。

如果属于 **该场景** 的 **NPC** 的编号是这样的：
```text
1 同学A
2 同学B
```

那么地图类会先从左到右，再从上到下分配，所以 (5, 6) 就是同学 A, (8, 2) 就是同学 B，出口也是同样的道理。

转角的合法性:

```text
##       ###     ##
  ###      ###    ####
❌       ✅      ✅
```

宽度大于 1 的特殊符号（包括主角和NPC）放置的合法性:

```text
 9#     9 #     99  #    9 9 #
###     ###     #####    #####
#       #       #        #
❌      ✅      ❌      ✅
```

#### 如何快速确定符号宽度？

```py
python
>>> print("\U码点        ")   # 不足 8 位高位补 0, 然后后面敲几个空格
```

举例：

```bash
>>> print("\U00002550   ")
═
```
